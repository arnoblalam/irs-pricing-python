align = TRUE,
column.labels = c("Basic Model", "Advanced Model"),
covariate.labels = c("Group",
"Period",
"Tenor",
"Log Notional",
"Capped",
"Morning Session",
"Afternoon Session",
"Off Hours",
"Monday",
"Tuesday",
"Thursday",
"Friday",
"Group * Period"),
dep.var.caption = "Dependent variable: Difference",
dep.var.labels.include = FALSE,
digits = 4,
no.space = TRUE)
summary(did_model_advanced)
# Load necessary packages
library(tidyverse)
library(readxl)
library(stargazer)
# Read the data from the Excel file
data <- read_excel("data/filtered_data.xlsx",
col_types = c("numeric", "text", "date", "text",
"numeric", "text", "text", "date",
"date", "numeric", "text", "numeric",
"text", "text", "numeric", "numeric",
"numeric", "text", "numeric", "date", "text",
"numeric", "text", "text", "text",
"text", "text", "numeric", "numeric",
"text", "text", "date", "numeric",
"numeric", "numeric"))
# Convert the 'Group', 'Phase', and 'Period' variables to factors
data$Group <- as.factor(data$Group)
data$Phase <- as.factor(data$Phase)
data$Period <- as.factor(data$Period)
# Convert the 'Capped', 'SEF', Trade Day and Trade Hour variables to factors
data$Capped <- as.factor(data$Capped)
data$SEF <- as.factor(data$SEF)
data$`Day Name` <- factor(data$`Day Name`, levels = c("Wednesday",
"Monday",
"Tuesday",
"Thursday",
"Friday",
"Saturday",
"Sunday"))
data$`Trade Hour Categorical` <- factor(data$`Trade Hour Categorical`,
levels = c("Mid Day",
"Morning",
"Afternoon",
"Off Hours"))
# Convert T to numeric
data$T <- as.numeric(data$T)
# Convert notional to log notional
data$Ln_notional <- log(data$Not.)
did_model <- lm(
Difference ~ Group * Period,
data = data)
summary(did_model)
did_model_advanced <- lm(
Difference ~ Group * Period + T + Ln_notional + Capped + `Trade Hour Categorical` + `Day Name`,
data = data)
summary(did_model_advanced)
# Create the summary table with both the basic and advanced DID regression models
stargazer(did_model_advanced, type = "text",
title = "Difference-in-Differences Regression Results",
align = TRUE,
column.labels = c("Basic Model", "Advanced Model"),
covariate.labels = c("Group",
"Period",
"Tenor",
"Log Notional",
"Capped",
"Morning Session",
"Afternoon Session",
"Off Hours",
"Monday",
"Tuesday",
"Thursday",
"Friday",
"Group * Period"),
dep.var.caption = "Dependent variable: Difference",
dep.var.labels.include = FALSE,
digits = 4,
no.space = TRUE)
# Create the summary table with both the basic and advanced DID regression models
stargazer(did_model, did_model_advanced, type = "text",
title = "Difference-in-Differences Regression Results",
align = TRUE,
column.labels = c("Basic Model", "Advanced Model"),
covariate.labels = c("Group",
"Period",
"Tenor",
"Log Notional",
"Capped",
"Morning Session",
"Afternoon Session",
"Off Hours",
"Monday",
"Tuesday",
"Thursday",
"Friday",
"Group * Period"),
dep.var.caption = "Dependent variable: Difference",
dep.var.labels.include = FALSE,
digits = 4,
no.space = TRUE)
View(data)
View(data)
# Load necessary packages
library(tidyverse)
library(readxl)
library(stargazer)
# Read the data from the Excel file
data <- read_excel("data/filtered_data.xlsx",
col_types = c("numeric", "text", "date", "text",
"numeric", "text", "text", "date",
"date", "numeric", "text", "numeric",
"text", "text", "numeric", "numeric",
"numeric", "text", "numeric", "date", "text",
"numeric", "text", "text", "text",
"text", "text", "numeric", "numeric",
"text", "text", "date", "numeric",
"numeric", "numeric"))
# Convert the 'Group', 'Phase', and 'Period' variables to factors
data$Group <- as.factor(data$Group)
data$Phase <- as.factor(data$Phase)
data$Period <- as.factor(data$Period)
# Convert the 'Capped', 'SEF', Trade Day and Trade Hour variables to factors
data$Capped <- as.factor(data$Capped)
data$SEF <- as.factor(data$SEF)
data$`Day Name` <- factor(data$`Day Name`, levels = c("Wednesday",
"Monday",
"Tuesday",
"Thursday",
"Friday",
"Saturday",
"Sunday"))
data$`Trade Hour Categorical` <- factor(data$`Trade Hour Categorical`,
levels = c("Mid Day",
"Morning",
"Afternoon",
"Off Hours"))
# Convert T to numeric
data$T <- as.numeric(data$T)
# Convert notional to log notional
data$Ln_notional <- log(data$Not.)
did_model <- lm(
Difference ~ Group * Period + Source.Name,
data = data)
summary(did_model)
did_model_advanced <- lm(
Difference ~ Group * Period + Source.Name + `T` + Ln_notional + Capped + `Trade Hour Categorical` + `Day Name`,
data = data)
summary(did_model_advanced)
# Create the summary table with both the basic and advanced DID regression models
stargazer(did_model, did_model_advanced, type = "text",
title = "Difference-in-Differences Regression Results",
align = TRUE,
column.labels = c("Basic Model", "Advanced Model"),
covariate.labels = c("Group",
"Period",
"Day FE",
"Tenor",
"Log Notional",
"Capped",
"Morning Session",
"Afternoon Session",
"Off Hours",
"Monday",
"Tuesday",
"Thursday",
"Friday",
"Group * Period"),
dep.var.caption = "Dependent variable: Difference",
dep.var.labels.include = FALSE,
digits = 4,
no.space = TRUE)
# Save the LaTeX output to a file
summary_table <- stargazer(did_model, did_model_advanced, type = "latex",
title = "Difference-in-Differences Regression Results",
align = TRUE,
column.labels = c("Basic Model", "Advanced Model"),
covariate.labels = c("Group", "Period", "Group * Period",
"Maturity", "Not.", "Capped", "SEF", "Trade Hour"),
dep.var.caption = "Dependent variable: Difference",
dep.var.labels.include = FALSE,
digits = 4,
no.space = TRUE)
# Save the LaTeX output to a file
summary_table <- stargazer(did_model, did_model_advanced, type = "latex",
title = "Difference-in-Differences Regression Results",
align = TRUE,
column.labels = c("Basic Model", "Advanced Model"),
covariate.labels = c("Group", "Period", "Group * Period",
"Maturity", "Not.", "Capped", "SEF", "Trade Hour"),
dep.var.caption = "Dependent variable: Difference",
dep.var.labels.include = FALSE,
digits = 4,
no.space = TRUE)
# Create the summary table with both the basic and advanced DID regression models
stargazer(did_model, did_model_advanced, type = "text",
title = "Difference-in-Differences Regression Results",
align = TRUE,
column.labels = c("Basic Model", "Advanced Model"),
covariate.labels = c("Group",
"Period",
"Day FE",
"Tenor",
"Log Notional",
"Capped",
"Morning Session",
"Afternoon Session",
"Off Hours",
"Monday",
"Tuesday",
"Thursday",
"Friday",
"Group * Period"),
dep.var.caption = "Dependent variable: Difference",
dep.var.labels.include = FALSE,
digits = 4,
no.space = TRUE)
# Read the data from the Excel file
data <- read_excel("data/filtered_data.xlsx",
col_types = c("numeric", "text", "date", "text",
"numeric", "text", "text", "date",
"date", "numeric", "text", "numeric",
"text", "text", "numeric", "numeric",
"numeric", "text", "numeric", "date", "text",
"numeric", "text", "text", "text",
"text", "text", "numeric", "numeric",
"text", "text", "date", "numeric",
"numeric", "numeric"))
# Convert the 'Group', 'Phase', and 'Period' variables to factors
data$Group <- as.factor(data$Group)
data$Phase <- as.factor(data$Phase)
data$Period <- as.factor(data$Period)
# Convert the 'Capped', 'SEF', Trade Day and Trade Hour variables to factors
data$Capped <- as.factor(data$Capped)
data$SEF <- as.factor(data$SEF)
data$`Day Name` <- factor(data$`Day Name`, levels = c("Wednesday",
"Monday",
"Tuesday",
"Thursday",
"Friday",
"Saturday",
"Sunday"))
data$`Trade Hour Categorical` <- factor(data$`Trade Hour Categorical`,
levels = c("Mid Day",
"Morning",
"Afternoon",
"Off Hours"))
# Convert T to numeric
data$`T` <- as.numeric(data$`T`)
# Convert file date to factor
data$`File Date` <- factor(data$`File Date`)
# Convert notional to log notional
data$Ln_notional <- log(data$Not.)
did_model <- lm(
Difference ~ Group * Period + `File Date`,
data = data)
summary(did_model)
# Create the summary table with both the basic and advanced DID regression models
stargazer(did_model, did_model_advanced, type = "text",
title = "Difference-in-Differences Regression Results",
align = TRUE,
column.labels = c("Basic Model", "Advanced Model"),
covariate.labels = c("Group",
"Period",
"Tenor",
"Log Notional",
"Capped",
"Morning Session",
"Afternoon Session",
"Off Hours",
"Monday",
"Tuesday",
"Thursday",
"Friday",
"Group * Period"),
dep.var.caption = "Dependent variable: Difference",
dep.var.labels.include = FALSE,
digits = 4,
no.space = TRUE)
# Save the LaTeX output to a file
summary_table <- stargazer(did_model, did_model_advanced, type = "text",
title = "Difference-in-Differences Regression Results",
align = TRUE,
column.labels = c("Basic Model", "Advanced Model"),
covariate.labels = c("Group", "Period", "Group * Period",
"Maturity", "Not.", "Capped", "SEF", "Trade Hour"),
dep.var.caption = "Dependent variable: Difference",
dep.var.labels.include = FALSE,
digits = 4,
no.space = TRUE,
out = "reports/tables/filtered_did.txt")
did_model <- lm(
Difference ~ Group * Period,
data = data)
summary(did_model)
did_model_advanced <- lm(
Difference ~ Group * Period + `T` + Ln_notional + Capped + `Trade Hour Categorical` + `Day Name`,
data = data)
summary(did_model_advanced)
# Create the summary table with both the basic and advanced DID regression models
stargazer(did_model, did_model_advanced, type = "text",
title = "Difference-in-Differences Regression Results",
align = TRUE,
column.labels = c("Basic Model", "Advanced Model"),
covariate.labels = c("Group",
"Period",
"Tenor",
"Log Notional",
"Capped",
"Morning Session",
"Afternoon Session",
"Off Hours",
"Monday",
"Tuesday",
"Thursday",
"Friday",
"Group * Period"),
dep.var.caption = "Dependent variable: Difference",
dep.var.labels.include = FALSE,
digits = 4,
no.space = TRUE)
# Save the LaTeX output to a file
summary_table <- stargazer(did_model, did_model_advanced, type = "text",
title = "Difference-in-Differences Regression Results",
align = TRUE,
column.labels = c("Basic Model", "Advanced Model"),
covariate.labels = c("Group", "Period", "Group * Period",
"Maturity", "Not.", "Capped", "SEF", "Trade Hour"),
dep.var.caption = "Dependent variable: Difference",
dep.var.labels.include = FALSE,
digits = 4,
no.space = TRUE,
out = "reports/tables/filtered_did.txt")
# Run separate DiD for each phase: adv model
phase_1_model_adv <- lm(
Difference ~ Group * Period + `T` + Ln_notional + Capped + `Trade Hour Categorical` + `Day Name`,
data = data %>% filter(Phase == "Phase 1"))
phase_2_model_adv <- lm(
Difference ~ Group * Period + `T` + Ln_notional + Capped + `Trade Hour Categorical` + `Day Name`,
data = data %>% filter(Phase == "Phase 2"))
# Run separate DiD for each phase: adv model
phase_1_model_adv <- lm(
Difference ~ Group * Period + `T` + Ln_notional + Capped + `Trade Hour Categorical` + `Day Name`,
data = data %>% filter(Phase == "Phase 1"))
phase_2_model_adv <- lm(
Difference ~ Group * Period + `T` + Ln_notional + Capped + `Trade Hour Categorical` + `Day Name`,
data = data %>% filter(Phase == "Phase 2"))
phase_3_model_adv <- lm(
Difference ~ Group * Period + `T` + Ln_notional + Capped + `Trade Hour Categorical` + `Day Name`,
data = data %>% filter(Phase == "Phase 3"))
stargazer(phase_1_model_adv, phase_2_model_adv, phase_3_model_adv,
type = "text",
align = TRUE,
column.labels = c("Phase 1", "Phase 2", "Phase 3"),
covariate.labels = c(
"Group",
"Period",
"Maturity",
"Notional",
"Capped",
"Morning Session",
"Afternoon Session",
"Off Hours",
"Monday",
"Tuesday",
"Thursday",
"Friday",
"Group * Period"),
title = "By Phase Results: Advanced Model")
stargazer(phase_1_model_adv, phase_2_model_adv, phase_3_model_adv,
type = "text",
align = TRUE,
column.labels = c("Phase 1", "Phase 2", "Phase 3"),
covariate.labels = c(
"Group",
"Period",
"Tenor",
"Notional",
"Capped",
"Morning Session",
"Afternoon Session",
"Off Hours",
"Monday",
"Tuesday",
"Thursday",
"Friday",
"Group * Period"),
title = "By Phase Results: Advanced Model")
# Read the data from the Excel file
data <- read_excel("data/USD_CAD_combined.xlsx",
col_types = c("text", "date", "text",
"numeric", "text", "text", "date",
"date", "numeric", "text", "numeric",
"text", "text", "numeric", "numeric",
"numeric", "text", "numeric", "date", "text",
"numeric", "text", "text", "text",
"text", "text", "numeric", "numeric",
"text", "text", "date", "numeric",
"numeric"))
warnings()
# Read the data from the Excel file
data <- read_excel("data/USD_CAD_combined.xlsx",
col_types = c("text", "date", "text",
"numeric", "text", "text", "date",
"date", "numeric", "text", "numeric",
"text", "text", "numeric", "numeric",
"text", "text", "text", "date", "text",
"numeric", "text", "text", "text",
"text", "text", "numeric", "numeric",
"text", "text", "date", "numeric",
"numeric"))
# Convert the 'Group', 'Phase', and 'Period' variables to factors
data$Group <- as.factor(data$Group)
data$Phase <- as.factor(data$Phase)
data$Period <- as.factor(data$Period)
# Convert the 'Capped', 'SEF', Trade Day and Trade Hour variables to factors
data$Capped <- as.factor(data$Capped)
data$SEF <- as.factor(data$SEF)
data$`Day Name` <- factor(data$`Day Name`, levels = c("Wednesday",
"Monday",
"Tuesday",
"Thursday",
"Friday",
"Saturday",
"Sunday"))
data$`Trade Hour Categorical` <- factor(data$`Trade Hour Categorical`,
levels = c("Mid Day",
"Morning",
"Afternoon",
"Off Hours"))
# Convert T to numeric
data$`T` <- as.numeric(data$`T`)
data$T
library(stringr)
?str_sub
data$T
# Read the data from the Excel file
data <- read_excel("data/USD_CAD_combined.xlsx",
col_types = c("text", "date", "text",
"numeric", "text", "text", "date",
"date", "numeric", "text", "numeric",
"text", "text", "numeric", "numeric",
"text", "text", "text", "date", "text",
"numeric", "text", "text", "text",
"text", "text", "numeric", "numeric",
"text", "text", "date", "numeric",
"numeric"))
# Convert the 'Group', 'Phase', and 'Period' variables to factors
data$Group <- as.factor(data$Group)
data$Phase <- as.factor(data$Phase)
data$Period <- as.factor(data$Period)
# Convert the 'Capped', 'SEF', Trade Day and Trade Hour variables to factors
data$Capped <- as.factor(data$Capped)
data$SEF <- as.factor(data$SEF)
data$`Day Name` <- factor(data$`Day Name`, levels = c("Wednesday",
"Monday",
"Tuesday",
"Thursday",
"Friday",
"Saturday",
"Sunday"))
data$`Trade Hour Categorical` <- factor(data$`Trade Hour Categorical`,
levels = c("Mid Day",
"Morning",
"Afternoon",
"Off Hours"))
data$T
str_sub(data$T, end=-1)
str_sub(data$T, end=-2)
# Convert T to numeric
data$T <- as.numeric(str_sub(data$T, end=-2))
# Convert notional to log notional
data$Ln_notional <- log(data$Not.)
did_model <- lm(
Difference ~ Group * Period,
data = data)
summary(did_model)
did_model_advanced <- lm(
Difference ~ Group * Period + `T` + Ln_notional + Capped + `Trade Hour Categorical` + `Day Name`,
data = data)
summary(did_model_advanced)
# Create the summary table with both the basic and advanced DID regression models
stargazer(did_model, did_model_advanced, type = "text",
title = "Difference-in-Differences Regression Results",
align = TRUE,
column.labels = c("Basic Model", "Advanced Model"),
covariate.labels = c("Group",
"Period",
"Tenor",
"Log Notional",
"Capped",
"Morning Session",
"Afternoon Session",
"Off Hours",
"Monday",
"Tuesday",
"Thursday",
"Friday",
"Group * Period"),
dep.var.caption = "Dependent variable: Difference",
dep.var.labels.include = FALSE,
digits = 4,
no.space = TRUE)
